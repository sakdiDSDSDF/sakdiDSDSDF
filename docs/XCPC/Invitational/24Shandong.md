# 2024 CCPC å…¨å›½é‚€è¯·èµ›ï¼ˆå±±ä¸œï¼‰æš¨å±±ä¸œçœå¤§å­¦ç”Ÿç¨‹åºè®¾è®¡ç«èµ›

> 2025-03-16
>
> 7é¢˜ ç½šæ—¶1247 é“¶

æ¯”èµ›é“¾æ¥: https://codeforces.com/gym/105385

æ¦œå•è¿æ¥: https://board.xcpcio.com/provincial-contest%2F2024%2Fshandong?group=official

ACé¡ºåº: I A F K C J D

Kæ˜¯æ„é€ çš„é‚£ä¸ªï¼Œæˆ‘ä¸€ç›´æ²¡æƒ³å‡ºæ¥ï¼Œå­¦å¼Ÿæƒ³å‡ºæ¥äº†ï¼Œå¯ä»¥çš„ã€‚

Dæ˜¯æœ€åçæçäº¤äº†ï¼Œç„¶åçœŸè¿‡äº†ï¼Œæ€è·¯æ˜¯å¯¹çš„ï¼ˆï¼‰ã€‚

ç„¶åå…¶ä»–é¢˜ç›®åŸºæœ¬éƒ½æ˜¯æ¨¡æ‹Ÿå§ï¼Œå…¶å®æœ‰çš„è¿˜æ˜¯æœ‰ä¸€ç‚¹éš¾åº¦çš„ã€‚ç®—æ˜¯æœ€è¿‘æ‰“å¾—æœ€å¥½çš„ä¸€åœºäº†ï¼Œä¸ç®¡æ€ä¹ˆè¯´ï¼Œè¯¥å†™å‡ºæ¥çš„é¢˜éƒ½å‡ºæ¥äº†ã€‚è™½ç„¶åƒäº†å¾ˆå¤šå‘ç½šæ—¶å°±æ˜¯äº†ã€‚ã€‚è¿˜æ˜¯å¤ªæ€¥äº†ä¸€ç‚¹ã€‚

## A

å°±æ˜¯ä¸€ä¸ªæ¯”è¾ƒåŸºç¡€çš„äºŒåˆ†ã€‚ã€‚ä½†æ˜¯ä½ checkçš„æ—¶å€™å’Œå¯èƒ½ä¼šè¶…è¿‡ `long long` ï¼Œè¿™ä¸ªæ•…äº‹å‘Šè¯‰æˆ‘ä»¬ï¼Œcheckçš„æ—¶å€™è¦å…»æˆåŠæ—¶ `return` çš„å¥½ä¹ æƒ¯ã€‚è¿™ä¸ªå…¶å®å‡ºç°çš„æ¬¡æ•°æŒºå¤šçš„ï¼Œæœ€å¥½æ³¨æ„ä¸€ä¸‹ã€‚

```cpp
using ll = long long;

void solve()
{
    int n, k;
    cin >> n >> k;
    vector<int> t(n + 1), l(n + 1), w(n + 1);
    for (int i = 1; i <= n; i++)
        cin >> t[i] >> l[i] >> w[i];
    ll lo = 0, hi = 4e18 + 1;
    auto check = [&](ll x)
    {
        ll res = 0;
        for (int i = 1; i <= n; i++)
        {
            ll y = 1LL * t[i] * l[i] + w[i];
            res += x / y * l[i] + min(1LL * l[i], (x % y) / t[i]);
            if (res >= k)
                return true;
        }
        // cerr<<res<<'\n';
        return res >= k;
    };
    while (lo < hi - 1)
    {
        ll mid = (lo + hi) >> 1;
        if (check(mid))
            hi = mid;
        else
            lo = mid;
    }
    // cerr<<check(10)<<'\n';
    cout << hi << '\n';
}
```

## C

å°‘æœ‰çš„ä¸€æ¬¡ACçš„é¢˜ã€‚ã€‚å…¶å®æŒºç®€å•ã€‚

åªç”¨è€ƒè™‘å·¦ç«¯ç‚¹åœ¨è‡ªå·±å‰é¢çš„å’Œè‡ªå·±ç›¸äº¤çš„çº¿æ®µï¼Œè‡ªå·±çš„é¢œè‰²åªè¦ä¸å’Œå®ƒä»¬ä¸€æ ·å°±å¥½äº†ã€‚

```cpp
using ll = long long;

constexpr int mod = 998244353;

void solve()
{
    int n, k;
    cin >> n >> k;
    vector<pair<int, int>> seg(n);
    for (int i = 0; i < n; i++)
        cin >> seg[i].first >> seg[i].second;
    sort(seg.begin(), seg.end());
    priority_queue<int, vector<int>, greater<>> pq;
    int cnt = 0;
    ll res = 1;
    for (int i = 0; i < n; i++)
    {
        while (!pq.empty() && pq.top() < seg[i].first)
        {
            pq.pop();
            cnt--;
        }
        if (k - cnt > 0)
        {
            // cerr << cnt << '\n';

            res = res * (k - cnt) % mod;
            pq.push(seg[i].second);
            cnt++;
        }
        else
        {
            res = 0;
            break;
        }
    }
    cout << res << '\n';
}
```

## D

åˆšå¼€å§‹æƒ³æ³•æ˜¯ï¼Œæœ€åˆå¯èƒ½å¯ä»¥å¾ˆå¤šæ¬¡æŠŠé’±èŠ±å…‰å»èµšé’±ï¼Œé‚£æˆ‘ä»¬å…ˆæŠŠè¿™ä¸ªæƒ…å†µç»™å¤„ç†å®Œï¼Œç„¶ååªèƒ½èŠ±ä¸€éƒ¨åˆ†çš„é’±äº†å› ä¸ºæ—¶é—´ä¸å¤Ÿï¼Œç„¶åè¿™ä¸€æ­¥æ˜¯å¯ä»¥äºŒåˆ†çš„ã€‚

æœ€å¼€å§‹å°±æ˜¯ç›´æ¥æ¨¡æ‹Ÿç¬¬ä¸€æ­¥çš„æ“ä½œï¼Œä½†æ˜¯åƒäº†å‡ å‘ TLE ï¼Œæœ¬æ¥æ„Ÿè§‰è¿™ä¸ªæ“ä½œä¸ä¼šå¾ˆå¤šæ¬¡ï¼Œé”™è¯¯çš„æ„Ÿè§‰äº†æ¬¡æ•°å¾ˆå°‘ã€‚ã€‚

ä½†æ˜¯å…¶å®è¿™ä¸ªç†Ÿç»ƒå¯èƒ½å’Œ `t` ä¼šæ˜¯ä¸€ä¸ªçº§åˆ«çš„ã€‚ã€‚ã€‚

ç„¶åå°±æƒ³åˆ°äº†ï¼Œå¯èƒ½æ˜¯éå¸¸å¤šæ¬¡éƒ½æ˜¯èƒ½ä¹°çš„æ•°é‡æ˜¯ä¸€æ ·çš„ï¼Œè¿™å°±ä¼šæµªè´¹éå¸¸å¤šçš„æ—¶é—´ã€‚

æ‰€ä»¥å¦‚æœè¿™ä¸€æ¬¡ä¹‹åï¼Œå¯ä»¥ä¹°çš„æ•°é‡æ²¡æœ‰å¢åŠ ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥è·³åˆ°ä¸‹ä¸€ä¸ª $\lfloor \frac{m}{p} \rfloor +1$ ã€‚å› ä¸ºä¸­é—´å¾ˆå¤šæ¬¡ä¹°çš„æ•°é‡æ˜¯ä¸€æ ·çš„ï¼Œä¹Ÿå°±æ˜¯èŠ±çš„æ—¶é—´å’Œé’±æ˜¯ä¸€æ ·çš„ï¼Œå¯ä»¥ç›´æ¥è·³è¿‡äº†ã€‚

è¿™æ ·å’±ä»¬æ¯æ¬¡åŠ çš„éƒ½æ˜¯ä¸åŒçš„æ•°é‡ï¼Œä¹°ä¸€ä¸ªæœ€å°‘éœ€è¦ $2$ æ—¶é—´ ï¼Œ æ‰€ä»¥ $2(1 + 2 + ... + k)\le t$ ï¼Œæ‰€ä»¥å¾ªç¯æ¬¡æ•°æœ€å¤š $\sqrt t$ æ¬¡ã€‚

ç„¶åå°±ç›´æ¥ç®—ç­”æ¡ˆå°±è¡Œï¼Œå…¶å®å¹¶ä¸éœ€è¦äºŒåˆ†äº†ã€‚ã€‚ã€‚ä½ çœ‹æˆ‘é‚£ä¸ªäºŒåˆ†ï¼Œç›´æ¥å†™ä¸ªé™¤æ³•å°±å¥½äº†çš„å§ã€‚ã€‚ã€‚

```cpp
using ll = long long;
using pii = pair<int, int>;

void solve()
{
    ll p, a, b, q, c, d, m, t;
    cin >> p >> a >> b >> q >> c >> d >> m >> t;

    /*
    (m/p)*(a+b)+c+d <= t

    */
    for (int i = 1;; i++)
    {

        ll x = m / p;
        if (!x)
            break;
        __int128 cost = a * x + b + c * x + d;
        if (cost <= t)
        {
            // cerr<<t<<'\n';
            t -= cost;
            m = q * x + (m % p);
        }
        else
            break;
        ll z = t / ((a + c) * x + b + d); // æœ€å¤šè¿˜èƒ½æ“ä½œçš„æ¬¡æ•°

        ll y = (x + 1) * p;
        if (m < y)
        {
            if (m + z * (q - p) * x < y)
            {
                m += z * x * (q - p);
                t %= ((a + c) * x + b + d);
                break;
            }
            else
            {
                ll zz = (y - m) / ((q - p) * x);
                m += zz * (q - p) * x;
                t -= zz * ((a + c) * x + b + d);
            }
        }
    }
    // cerr << "m t: " << m << " " << t << '\n';
    auto check = [&](ll x)
    {
        return (__int128)a * x + b + c * x + d <= t;
    };
    ll lo = 0, hi = m / p + 1;
    while (lo < hi - 1)
    {
        ll mid = (lo + hi) >> 1;
        if (check(mid))
            lo = mid;
        else
            hi = mid;
    }
    m += (q - p) * lo;
    cout << m << '\n';
}
```

## F

ä» $k=n$ å¼€å§‹è€ƒè™‘ã€‚æˆ‘ä»¬å¦‚æœè¦ç®— $n-1$ çš„æƒ…å†µï¼Œå°±æ˜¯æŠŠæŸä¸¤ä¸ªç›¸é‚»çš„æ•°å­—åˆå¹¶åˆ°ä¸€èµ·ã€‚

é‚£ä¹ˆè¿™ä¸ªè´¡çŒ®æ˜¯å¤šå°‘å‘¢ï¼Ÿ

æˆ‘ä»¬åªè€ƒè™‘å‘ååˆå¹¶çš„ï¼Œæ¯”å¦‚æŠŠ $a_i$ å’Œ $a_{i+1}$ åˆå¹¶åˆ°ä¸€èµ·ã€‚é‚£ä¹ˆåé¢çš„æ‰€æœ‰æ•°å­—çš„ä¸‹æ ‡éƒ½ä¼š $-1$ ï¼Œè€Œ $a_i$ è‡ªå·±ï¼Œæœ¬è´¨ä¸Šå®ƒçš„è´¡çŒ®æ˜¯ä¸å˜çš„ã€‚æ‰€ä»¥å¯¹äºæ¯ä¸€ä¸ª $i$ ï¼ŒæŠŠå®ƒå‘ååˆå¹¶ï¼Œäº§ç”Ÿçš„è´¡çŒ®ä¼šæ˜¯ $-suf_{i+1}$ ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦æ¯æ¬¡æ‰¾æœ€å°çš„åç¼€ï¼Œé‚£ä¹ˆæ–°çš„å€¼å°±æ˜¯ä¸Šä¸€ä¸ªçš„å‡å»è¿™ä¸ªåç¼€ã€‚

```cpp
using ll = long long;
using pll = pair<long long, long long>;

void solve()
{
    int n;
    cin >> n;
    vector<ll> ans;
    vector<int> a(n + 1);
    ll now = 0;
    for (int i = 1; i <= n; i++)
    {
        cin >> a[i];
        now += 1LL * a[i] * i;
    }
    // ans[n] = now;
    ans.push_back(now);
    ll suf = a[n];
    set<pll> st1, st2;
    st2.insert({1, a[1]});
    st2.insert({n, a[n]});
    if (n > 1)
        st1.insert({suf, n});
    for (int i = n - 1; i >= 2; i--)
    {
        suf += a[i];
        st1.insert({suf, i});
        st2.insert({i, a[i]});
    }
    while (!st1.empty())
    {
        auto [val, i] = *st1.begin();
        st1.erase(st1.begin());
        auto it = st2.lower_bound({i, 0});
        auto [j1, x1] = *it;
        auto [j2, x2] = *prev(it);
        now -= val;
        ans.push_back(now);
        st2.erase({j1, x1});
        st2.erase({j2, x2});
        st2.insert({j2, x1 + x2});
    }
    reverse(ans.begin(), ans.end());
    for (auto x : ans)
        cout << x << " ";
    cout << '\n';
}
```

## I

åªæœ‰å‡ºç°ä¸¤ä¸ªç›¸åŒå­—ç¬¦ç›¸é‚»çš„æƒ…å†µï¼Œæˆ–è€…åŸæœ¬å°±æ˜¯é¦–å°¾ç›¸åŒï¼Œæ‰æ˜¯å¯ä»¥çš„ã€‚

```cpp
void solve()
{
    string s;
    cin>>s;
    if(s.front()==s.back()){
        cout<<"0\n";
        return;
    }
    for(int i=0;i+1<s.size();i++){
        if(s[i]==s[i+1]){
            cout<<i+1<<'\n';
            return;
        }
    }
    cout<<"-1\n";
}
```

## J

å…¶å®ä¹Ÿä¸éš¾çš„ï¼Œå¿˜è®° `long long` WA äº†ä¸€æ¬¡ï¼Œå½“ç„¶ç¬¬ä¸€æ¬¡æ˜¯å› ä¸ºå†™äº†ä¸€ä¸ªé”™çš„åšæ³•ã€‚

æˆ‘ä»¬å¯ä»¥æ¢ä¸€ä¸ªæƒ³æ³•å•Šï¼Œå°±æ˜¯æˆ‘ä»¬å…ˆæŠŠ $n$ ä¸ªä¸åŒé¢œè‰²çš„ç‚¹è¿æˆä¸€é¢—æƒå€¼æœ€å°çš„æ ‘ï¼Œç„¶åå†æŠŠå‰©ä¸‹çš„æ‰€æœ‰ç‚¹ï¼Œç›´æ¥å…¨éƒ¨è¿æƒå€¼æœ€å°çš„è¾¹ã€‚å› ä¸ºç»è¿‡ç¬¬ä¸€æ­¥æ“ä½œä¹‹åï¼Œæ‰€æœ‰ç‚¹éƒ½åœ¨æ ‘ä¸Šäº†ï¼Œå‰©ä¸‹çš„ç›´æ¥å“ªä¸ªå°è¿å“ªä¸ªå°±è¡Œäº†ã€‚

ç”±äºæ¯ä¸ªé¢œè‰²çš„ç‚¹ä¸€å®šä¸å¯èƒ½åªè¿è‡ªå·±èº«ä¸Šçš„ï¼Œä¸€å®šä¼šæœ‰è¿åˆ°åˆ«çš„ç‚¹ä¸Šçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿™æ ·åšå°±ä¸€å®šæ˜¯å¯¹çš„ã€‚

```cpp
using ll = long long;
using pii = pair<int, int>;

void solve()
{
    int n;
    cin >> n;
    vector<int> a(n + 1);
    vector<vector<int>> b(n + 1, vector<int>(n + 1));
    ll sum = 0;
    for (int i = 1; i <= n; i++)
        cin >> a[i], a[i]--;
    for (int i = 1; i <= n; i++)
        for (int j = 1; j <= n; j++)
            cin >> b[i][j];
    set<int> vis;
    priority_queue<pii, vector<pii>, greater<>> pq;
    // å…ˆæ¯ç§é¢œè‰²éƒ½åªç”¨ä¸€ä¸ªç‚¹ å†æ…¢æ…¢åŠ ä¸Šå»
    vis.insert(1);
    for (int i = 2; i <= n; i++)
        pq.push({b[1][i], i});
    while (!pq.empty())
    {
        auto [val, i] = pq.top();
        pq.pop();
        if (vis.count(i))
            continue;
        vis.insert(i);
        sum += val;
        for (int j = 1; j <= n; j++)
        {
            if (vis.count(j))
                continue;
            pq.push({b[i][j], j});
        }
    }
    // cerr << sum << '\n';
    for(int i=1;i<=n;i++){
        sum+=1LL*a[i]*(*min_element(b[i].begin()+1,b[i].end()));
    }
    cout<<sum<<'\n';
}
```

## K

æ„é€ é¢˜ã€‚ã€‚

æ–¹æ³•å…¶å®ä¹Ÿæ˜¯æŒºå¤šçš„ã€‚

é¢˜è§£çš„æ˜¯å‰ n-2 è¡Œ ï¼Œæ¯è¡Œéƒ½ç”¨ 1 ä¸ªä¸åŒçš„æ•°å­—ã€‚

ç„¶åæœ€åä¸¤è¡Œï¼Œå‰ n-2 åˆ—ï¼Œæ¯åˆ— 2 ä¸ªä¸€æ ·çš„æ•°å­—ï¼Œæœ€åå››ä¸ªæ•°å­—ç”¨ä¸ä¸€æ ·çš„æ•°å­—ã€‚

```
1111
2222
3456
3478
```

å¥½ç‰›ã€‚ã€‚ã€‚

æˆ‘ä»¬çš„æ˜¯å››ä¸ªè§’æ”¾ä¸åŒçš„ï¼Œç„¶åç¬¬ä¸€è¡Œå‰©ä½™çš„ä½ç½®æ”¾ä¸åŒçš„æ•°å­—ï¼Œæœ€åä¸€è¡Œå’Œå®ƒç›¸åŒï¼Œç„¶åå‰©ä½™çš„æ¯è¡Œå¡«ä¸€ä¸ªä¸åŒçš„æ•°å­—ã€‚ã€‚

ä¹Ÿæ˜¯éå¸¸çš„å¯¹ã€‚

è¿™é¢˜ [å­¦å¼Ÿ](https://codeforces.com/profile/Dragon66677750) æ‹¿äº† `mvp` ğŸ˜ğŸ˜ğŸ˜ã€‚

```
1562
7777
8888
3564
```

```cpp
using ll = long long;

void solve()
{
    int n;
    cin>>n;
    vector<vector<int>>a(n+1,vector<int>(n+1));
    a[1][1]=1,a[1][n]=2,a[n][1]=3,a[n][n]=4;
    int tot=5;
    for(int i=2;i<n;i++){
        a[1][i]=a[n][i]=tot++;
    }
    for(int i=2;i<n;i++){
        for(int j=1;j<=n;j++)
            a[i][j]=tot;
        tot++;
    }
    cout<<"Yes\n";
    for(int i=1;i<=n;i++)
        for(int j=1;j<=n;j++)
            cout<<a[i][j]<<" \n"[j==n];
}
```